<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ethereum Light</title>
</head>
<body>
    <h1>Nim interop test</h1>

    <input id="aInput" type="text" value="10" />
    <button id="setButton">Save</button>
    <br />
    <input id="getOutput" type="text" readonly="readonly" />
    <button id="getButton">Load</button>

    <script>
        var foo = undefined;

        var Module = {
            onRuntimeInitialized: function() {
                document.getElementById('setButton').addEventListener('click', function() {
                    if (foo !== undefined) {
                        Module['_destroyFoo'](foo);
                    }

                    let a = parseInt(document.getElementById('aInput').value, 10);
                    foo = Module['_createFoo'](a);

                    Module['_destroyFoo'](foo);
                });
                document.getElementById('getButton').addEventListener('click', function() {
                    if (foo === undefined) {
                        return;
                    }
                    let result = Module['_getA'](foo);
                    document.getElementById('getOutput').value = result;
                });
            }
        };
    </script>
    <script async src="main.js"></script>
</body>
</html>
